# SISTEMA SIGEPOLI (ISPTEC)

## CONTEXTO E OBJETIVO
**Sistema de GestÃ£o Escolar PolitÃ©cnica (SIGEPOLI)** - Banco de dados relacional que integra gestÃ£o acadÃ©mica, administrativa e operacional para o Instituto Superior PolitÃ©cnico de Tecnologias e CiÃªncias (ISPTEC).

### 1. Objetivo Geral
Desenhar, modelar e implementar um banco de dados relacional que integre a gestÃ£o acadÃ©mica (cursos, turmas, matrÃ­culas e avaliaÃ§Ãµes), a gestÃ£o de pessoas (professores, coordenadores, administrativos) e a gestÃ£o operacional (contratos com empresas de serviÃ§os de limpeza, seguranÃ§a e cafetaria), garantindo rastreabilidade, controlo de custos e relatÃ³rios de desempenho.

---

### 2. Contexto do Problema
O Instituto Superior PolitÃ©cnico de Tecnologias e CiÃªncias, assim como vÃ¡rios outros institutos, opera com vÃ¡rias Ã¡reas interligadas:

1. **AcadÃ©mica** â€“ oferecimento de cursos, criaÃ§Ã£o de turmas, matrÃ­cula de alunos, atribuiÃ§Ã£o de professores e avaliaÃ§Ã£o de desempenho discente.
2. **Administrativa** â€“ pessoal administrativo distribuÃ­do por departamentos (Secretaria AcadÃ©mica, Tesouraria, Recursos Humanos, Biblioteca, LaboratÃ³rios, etc.).
3. **CoordenaÃ§Ã£o PedagÃ³gica** â€“ coordenadores de curso responsÃ¡veis por currÃ­culos, grade horÃ¡ria e indicadores de qualidade.
4. **Operacional** â€“ contrataÃ§Ã£o e fiscalizaÃ§Ã£o de empresas terceirizadas (limpeza, seguranÃ§a, cafetaria) com metas de SLA (Service Level Agreement) e pagamentos mensais.

O sistema atual apresenta dados dispersos, gerando redundÃ¢ncia, falhas e dificuldade de apuraÃ§Ã£o de custos.

---

### 3. Requisitos Funcionais
- **RF01** â€“ Cadastrar departamentos, incluindo orÃ§amento anual e chefe responsÃ¡vel.
- **RF02** â€“ Registrar colaboradores administrativos, vinculando-os a um departamento.
- **RF03** â€“ Cadastrar professores e respectiva titulaÃ§Ã£o.
- **RF04** â€“ Designar coordenadores por curso.
- **RF05** â€“ Gerir cursos, disciplinas, turmas e horÃ¡rios.
- **RF06** â€“ Processar matrÃ­culas de alunos nas turmas.
- **RF07** â€“ LanÃ§ar avaliaÃ§Ãµes e obter mÃ©dias.
- **RF08** â€“ Cadastrar empresas terceirizadas, contratos e SLA.
- **RF09** â€“ Registar pagamentos mensais Ã s empresas com controle de SLA.
- **RF10** â€“ Gerar relatÃ³rios de carga horÃ¡ria, salas e custos.
- **RF11** â€“ Manter auditoria de alteraÃ§Ãµes sensÃ­veis.

---

### 4. Regras de NegÃ³cio ObrigatÃ³rias
- **RN01** â€“ Um professor nÃ£o pode ter aulas em turmas com horÃ¡rios sobrepostos.
- **RN02** â€“ SÃ³ Ã© permitida matrÃ­cula se houver vaga e propina paga.
- **RN03** â€“ Notas devem estar entre 0â€“20.
- **RN04** â€“ Empresas precisam apresentar garantia vÃ¡lida antes do pagamento.
- **RN05** â€“ SLA inferior a 90% gera multa automÃ¡tica.
- **RN06** â€“ Coordenador deve aprovar carga horÃ¡ria dos professores do curso.

---

#### **EntregÃ¡veis e PontuaÃ§Ã£o**
- **Modelo Conceitual (ER)**: 5 pontos - â‰¥10 entidades, relaÃ§Ãµes N:M resolvidas
- **Modelo LÃ³gico (DER)**: 3 pontos - Tipos adequados, PKs/FKs, 3FN
- **Script DDL**: 2 pontos - CHECK, UNIQUE, INDEX, ON UPDATE/DELETE
- **Procedures**: 2 pontos - Matricular, alocar, processar pagamento
- **Functions**: 3 pontos - MÃ©dia ponderada, percentual SLA
- **Triggers**: 5 pontos - Auditoria, bloqueios automÃ¡ticos
- **Views**: 2 pontos - Grade horÃ¡ria, carga horÃ¡ria, custos
- **Consultas de Teste**: 1 ponto - â‰¥10 INSERTs + â‰¥15 consultas
- **DocumentaÃ§Ã£o**: 2 pontos - Guia implantaÃ§Ã£o, diagrama fÃ­sico

---

## IMPLEMENTACAO

> SGBD -> MySQL

### 6. ESTRUTURA 

#### **Arquivos SQL**
```
sigepoli/
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ 01_schema/
â”‚   â”‚   â”œâ”€â”€ 01_create_database.sql
â”‚   â”‚   â”œâ”€â”€ 02_create_tables.sql
â”‚   â”‚   â”œâ”€â”€ 03_create_constraints.sql
â”‚   â”‚   â””â”€â”€ 04_create_indexes.sql
â”‚   â”œâ”€â”€ 02_programmability/
â”‚   â”‚   â”œâ”€â”€ procedures.sql
â”‚   â”‚   â”œâ”€â”€ functions.sql
â”‚   â”‚   â””â”€â”€ triggers.sql
â”‚   â”œâ”€â”€ 03_views/
â”‚   â”‚   â””â”€â”€ views.sql
â”‚   â”œâ”€â”€ 04_data/
â”‚   â”‚   â””â”€â”€ insert_test_data.sql
â”‚   â””â”€â”€ 05_tests/
â”‚       â”œâ”€â”€ test_queries.sql
â”‚       â””â”€â”€ validate_rules.sql
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ deploy_completo.sql
â”‚   â”œâ”€â”€ deploy_monolitico.sql
â”‚   â””â”€â”€ reset_database.sql
â”œâ”€â”€ README.md
â”œâ”€â”€ modelo_conceitual
â”œâ”€â”€ modelo_logico
â”œâ”€â”€ guia_implantacao
â”œâ”€â”€ justificativas_indices
â””â”€â”€ relatorio_1_pagina
```

### 1. ÃREA ACADÃŠMICA ğŸ“š

#### **Estrutura de Cursos e Disciplinas**
- [x] `courses` â€” Cadastro de cursos oferecidos
- [x] `subjects` â€” CatÃ¡logo de disciplinas
- [x] `course_subjects` â€” RelaÃ§Ã£o curso-disciplina com prÃ©-requisitos
- [x] `course_availability` â€” Vagas disponÃ­veis por ano letivo

#### **GestÃ£o de Turmas e HorÃ¡rios**
- [x] `classes` â€” Turmas por curso
- [x] `time_slots` â€” PerÃ­odos de aula
- [x] `class_schedules` â€” HorÃ¡rios das turmas
- [x] `rooms` â€” Salas de aula
- [x] `resources` â€” Recursos disponÃ­veis
- [x] `room_resources` â€” Recursos por sala
- [x] `room_bookings` â€” Reservas especiais de salas

#### **GestÃ£o de Alunos**
- [x] `students` â€” Dados dos alunos
- [x] `student_enrollments` â€” MatrÃ­cula em cursos
- [x] `class_enrollments` â€” MatrÃ­culas em disciplinas em dadas turmas

#### **GestÃ£o de Professores**
- [x] `teachers` â€” Dados dos docentes
- [x] `teacher_specializations` â€” EspecializaÃ§Ãµes dos professores
- [x] `teacher_availability` â€” Disponibilidade/carga horÃ¡ria

#### **Sistema de AvaliaÃ§Ã£o**
- [x] `grades` â€” Notas dos alunos
- [x] `assessment_types` â€” Tipos de avaliaÃ§Ã£o
- [x] `attendance` â€” Controle de presenÃ§as
- [x] `classes_attended` â€” Aulas ministradas

---

### 2. ÃREA ADMINISTRATIVA ğŸ¢

#### **GestÃ£o de Pessoal**
- [x] `users` â€” Dados centrais de todos os utilizadores
- [x] `user_roles` â€” PapÃ©is no sistema
- [x] `user_role_assignments` â€” Relacionamento usuÃ¡rio-papel
- [x] `user_identification` â€” Documentos de identificaÃ§Ã£o
- [x] `user_health` â€” InformaÃ§Ãµes de saÃºde
- [x] `departments` â€” Estrutura departamental
- [x] `department_budgets` â€” OrÃ§amento anual por departamento
- [x] `staff` â€” FuncionÃ¡rios administrativos
- [x] `academic_qualifications` â€” QualificaÃ§Ãµes dos funcionÃ¡rios
- [x] `positions` â€” Cargos disponÃ­veis
- [x] `staff_positions` â€” Cargos dos funcionÃ¡rios
- [x] `staff_leaves` â€” FÃ©rias e licenÃ§as
- [x] `evaluation` â€” AvaliaÃ§Ãµes de desempenho
- [x] `staff_evaluation` â€” AvaliaÃ§Ãµes especÃ­ficas de funcionÃ¡rios
- [x] `course_evaluation` â€” AvaliaÃ§Ãµes de cursos pelos alunos
- [x] `performance` â€” Resultados das avaliaÃ§Ãµes de desempenho
- [x] `course_access` â€” InscriÃ§Ãµes de alunos nos cursos

#### **CoordenaÃ§Ã£o de Cursos**
- [x] `courses.coordinator_user_id` - Coordenadores atribuÃ­dos (RF04)
  - **VALIDAÃ‡ÃƒO**: Apenas coordenadores aprovam carga horÃ¡ria (RN06)

#### **Secretaria AcadÃ©mica (crÃ­tica para ISPTEC)**
- [x] `services` â€” ServiÃ§os prestados pela instituiÃ§Ã£o
- [x] `service_types` â€” Categorias de serviÃ§os
- [x] `service_evaluation` â€” AvaliaÃ§Ãµes de serviÃ§os

#### **Tesouraria (crÃ­tica para ISPTEC)**
- [x] `payments` â€” Pagamentos gerais
- [x] `payment_types` â€” Tipos de pagamento
- [x] `studant_payments` â€” Pagamentos de alunos por serviÃ§os
- [x] `company_payments` â€” Pagamentos a empresas terceirizadas
- [x] `staff_payments` â€” Pagamentos a funcionÃ¡rios
- [x] `fines` â€” Multas aplicadas a alunos e empresas

#### **Biblioteca**
- [x] `library_items` â€” CatÃ¡logo geral da biblioteca
- [x] `library_loans` â€” EmprÃ©stimos e devoluÃ§Ãµes

---

### 3. ÃREA OPERACIONAL âš™ï¸

#### **GestÃ£o de ServiÃ§os, Pagamentos e Terceirizados**
- [x] `companies` â€” Empresas terceirizadas
- [x] `companies_departments` â€” RelaÃ§Ã£o empresas-departamentos
- [x] `companies_contracts` â€” Contratos com empresas
- [x] `companies_sla` â€” Acordos de nÃ­vel de serviÃ§o
- [x] `companies_sla_evaluation` â€” AvaliaÃ§Ãµes dos SLA
- [x] `companies_sla_definitions` â€” DefiniÃ§Ãµes dos termos dos SLA

#### **Monitoramento e Pagamentos**
  - **VALIDAÃ‡ÃƒO**: Verifica garantia vÃ¡lida antes do pagamento (RN04)
  - **VALIDAÃ‡ÃƒO**: Multa automÃ¡tica se SLA < 90% (RN05)

---

### 4. ÃREAS TRANSVERSAIS ğŸ”„

#### **Auditoria**
- [x] `audit_logs` â€” Logs de auditoria

#### **RelatÃ³rios** (Consultas, nÃ£o tabelas)
- **RF10**: RelatÃ³rios de carga horÃ¡ria, salas e custos
- **Views necessÃ¡rias**:
  - Grade horÃ¡ria por curso
  - Carga horÃ¡ria por professor
  - Resumo de custos de serviÃ§os por mÃªs

#### **NotificaÃ§Ãµes**
- [x] `notifications` â€” NotificaÃ§Ãµes do sistema

---

### 5. VALIDAÃ‡Ã•ES E REGRAS DE NEGÃ“CIO

#### **Procedures (RF - Matricular, Alocar, Processar)**
- [ ] `sp_matricular_aluno` - MatrÃ­cula com validaÃ§Ã£o de vaga e propina (RN02)
- [ ] `sp_alocar_professor` - AlocaÃ§Ã£o sem sobreposiÃ§Ã£o de horÃ¡rios (RN01)
- [ ] `sp_processar_pagamento` - Pagamento com cÃ¡lculo de multa (RN05)

#### **Functions (CÃ¡lculos)**
- [ ] `fn_calcular_media_ponderada` - MÃ©dia ponderada do aluno
- [ ] `fn_calcular_percentual_sla` - Percentual de SLA mensal

#### **Triggers (ValidaÃ§Ãµes AutomÃ¡ticas)**
- [ ] `tr_validar_sobreposicao_horario` - Previne sobreposiÃ§Ã£o de horÃ¡rios (RN01)
- [ ] `tr_validar_nota_range` - Valida notas entre 0-20 (RN03)
- [ ] `tr_bloquear_pagamento_sem_garantia` - Bloqueia pagamento sem garantia (RN04)
- [ ] `tr_auditoria_matriculas` - Auditoria de matrÃ­culas (RF11)
- [ ] `tr_auditoria_pagamentos` - Auditoria de pagamentos (RF11)

#### **Views (RelatÃ³rios)**
- [ ] `vw_grade_horaria_curso` - Grade horÃ¡ria por curso
- [ ] `vw_carga_horaria_professor` - Carga horÃ¡ria por professor
- [ ] `vw_custos_servicos_mes` - Resumo de custos mensais

---