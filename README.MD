# SISTEMA SIGEPOLI (ISPTEC)

## CONTEXTO E OBJETIVO
**Sistema de GestÃ£o Escolar PolitÃ©cnica (SIGEPOLI)** - Banco de dados relacional que integra gestÃ£o acadÃ©mica, administrativa e operacional para o Instituto Superior PolitÃ©cnico de Tecnologias e CiÃªncias (ISPTEC).

### 1. Objetivo Geral
Desenhar, modelar e implementar um banco de dados relacional que integre a gestÃ£o acadÃ©mica (cursos, turmas, matrÃ­culas e avaliaÃ§Ãµes), a gestÃ£o de pessoas (professores, coordenadores, administrativos) e a gestÃ£o operacional (contratos com empresas de serviÃ§os de limpeza, seguranÃ§a e cafetaria), garantindo rastreabilidade, controlo de custos e relatÃ³rios de desempenho.

---

### 2. Contexto do Problema
O Instituto Superior PolitÃ©cnico de Tecnologias e CiÃªncias, assim como vÃ¡rios outros institutos, opera com vÃ¡rias Ã¡reas interligadas:

1. **AcadÃ©mica** â€“ oferecimento de cursos, criaÃ§Ã£o de turmas, matrÃ­cula de alunos, atribuiÃ§Ã£o de professores e avaliaÃ§Ã£o de desempenho discente.
2. **Administrativa** â€“ pessoal administrativo distribuÃ­do por departamentos (Secretaria AcadÃ©mica, Tesouraria, Recursos Humanos, Biblioteca, LaboratÃ³rios, etc.).
3. **CoordenaÃ§Ã£o PedagÃ³gica** â€“ coordenadores de curso responsÃ¡veis por currÃ­culos, grade horÃ¡ria e indicadores de qualidade.
4. **Operacional** â€“ contrataÃ§Ã£o e fiscalizaÃ§Ã£o de empresas terceirizadas (limpeza, seguranÃ§a, cafetaria) com metas de SLA (Service Level Agreement) e pagamentos mensais.

O sistema atual apresenta dados dispersos, gerando redundÃ¢ncia, falhas e dificuldade de apuraÃ§Ã£o de custos.

---

### 3. Requisitos Funcionais
- **RF01** â€“ Cadastrar departamentos, incluindo orÃ§amento anual e chefe responsÃ¡vel.
- **RF02** â€“ Registrar colaboradores administrativos, vinculando-os a um departamento.
- **RF03** â€“ Cadastrar professores e respectiva titulaÃ§Ã£o.
- **RF04** â€“ Designar coordenadores por curso.
- **RF05** â€“ Gerir cursos, disciplinas, turmas e horÃ¡rios.
- **RF06** â€“ Processar matrÃ­culas de alunos nas turmas.
- **RF07** â€“ LanÃ§ar avaliaÃ§Ãµes e obter mÃ©dias.
- **RF08** â€“ Cadastrar empresas terceirizadas, contratos e SLA.
- **RF09** â€“ Registar pagamentos mensais Ã s empresas com controle de SLA.
- **RF10** â€“ Gerar relatÃ³rios de carga horÃ¡ria, salas e custos.
- **RF11** â€“ Manter auditoria de alteraÃ§Ãµes sensÃ­veis.

---

### 4. Regras de NegÃ³cio ObrigatÃ³rias
- **RN01** â€“ Um professor nÃ£o pode ter aulas em turmas com horÃ¡rios sobrepostos.
- **RN02** â€“ SÃ³ Ã© permitida matrÃ­cula se houver vaga e propina paga.
- **RN03** â€“ Notas devem estar entre 0â€“20.
- **RN04** â€“ Empresas precisam apresentar garantia vÃ¡lida antes do pagamento.
- **RN05** â€“ SLA inferior a 90% gera multa automÃ¡tica.
- **RN06** â€“ Coordenador deve aprovar carga horÃ¡ria dos professores do curso.

---

#### **EntregÃ¡veis e PontuaÃ§Ã£o**
- **Modelo Conceitual (ER)**: 5 pontos - â‰¥10 entidades, relaÃ§Ãµes N:M resolvidas
- **Modelo LÃ³gico (DER)**: 3 pontos - Tipos adequados, PKs/FKs, 3FN
- **Script DDL**: 2 pontos - CHECK, UNIQUE, INDEX, ON UPDATE/DELETE
- **Procedures**: 2 pontos - Matricular, alocar, processar pagamento
- **Functions**: 3 pontos - MÃ©dia ponderada, percentual SLA
- **Triggers**: 5 pontos - Auditoria, bloqueios automÃ¡ticos
- **Views**: 2 pontos - Grade horÃ¡ria, carga horÃ¡ria, custos
- **Consultas de Teste**: 1 ponto - â‰¥10 INSERTs + â‰¥15 consultas
- **DocumentaÃ§Ã£o**: 2 pontos - Guia implantaÃ§Ã£o, diagrama fÃ­sico

---

## IMPLEMENTACAO

### 6. ESTRUTURA 

#### **Arquivos SQL**
```
sigepoli/
â”œâ”€â”€ sql/
â”‚   â”œâ”€â”€ 01_schema/
â”‚   â”‚   â”œâ”€â”€ 01_create_database.sql
â”‚   â”‚   â”œâ”€â”€ 02_create_tables.sql
â”‚   â”‚   â”œâ”€â”€ 03_create_constraints.sql
â”‚   â”‚   â””â”€â”€ 04_create_indexes.sql
â”‚   â”œâ”€â”€ 02_programmability/
â”‚   â”‚   â”œâ”€â”€ procedures.sql
â”‚   â”‚   â”œâ”€â”€ functions.sql
â”‚   â”‚   â””â”€â”€ triggers.sql
â”‚   â”œâ”€â”€ 03_views/
â”‚   â”‚   â””â”€â”€ views.sql
â”‚   â”œâ”€â”€ 04_data/
â”‚   â”‚   â””â”€â”€ insert_test_data.sql
â”‚   â””â”€â”€ 05_tests/
â”‚       â”œâ”€â”€ test_queries.sql
â”‚       â””â”€â”€ validate_rules.sql
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ deploy_completo.sql
â”‚   â”œâ”€â”€ deploy_monolitico.sql
â”‚   â””â”€â”€ reset_database.sql
â”œâ”€â”€ README.md
â”œâ”€â”€ modelo_conceitual
â”œâ”€â”€ modelo_logico
â”œâ”€â”€ guia_implantacao
â”œâ”€â”€ justificativas_indices
â””â”€â”€ relatorio_1_pagina
```

### 1. ÃREA ACADÃ‰MICA ğŸ“š

#### **Estrutura de Cursos e Disciplinas**
- [x] `courses` - Cadastro de cursos oferecidos (RF05)
- [x] `subjects` - CatÃ¡logo de disciplinas (RF05)
- [x] `course_subjects` - RelaÃ§Ã£o curso-disciplina com prÃ©-requisitos (RF05)
- [x] `course_availability` - Vagas disponÃ­veis por ano letivo (RF06 - controle de vagas)
- [ ] **`course_fees`** - Propinas por curso/semestre (RF02, RN02 - controle de matrÃ­cula)

#### **GestÃ£o de Turmas e HorÃ¡rios**
- [x] `classes` - Turmas por disciplina (RF05)
- [x] `time_slots` - PerÃ­odos de aula (RF05)
- [x] `class_schedules` - HorÃ¡rios das turmas (RF05)
- [x] `rooms` - Salas de aula (RF10 - relatÃ³rios de utilizaÃ§Ã£o)
- [x] `resources` - Recursos disponÃ­veis
- [x] `classroom_resources` - Recursos por sala

#### **GestÃ£o de Alunos**
- [x] `students` - Dados acadÃ©micos dos alunos (RF06)
- [x] `class_enrollments` - MatrÃ­culas em turmas (RF06)
  - **VALIDAÃ‡ÃƒO**: Controle de vaga (RN02) via `course_availability`
- [ ] **`student_payments`** - Pagamentos de propinas (RN02 - sÃ³ matricula se propina paga)

#### **GestÃ£o de Professores**
- [x] `teachers` - Dados dos docentes (RF03)
- [ ] **`teacher_qualifications`** - TitulaÃ§Ã£o dos professores (RF03 - cadastrar titulaÃ§Ã£o)
- [ ] **`teacher_availability`** - Carga horÃ¡ria (RN06 - coordenador aprova)

#### **Sistema de AvaliaÃ§Ã£o**
- [x] `grades` - Notas dos alunos (RF07)
  - **VALIDAÃ‡ÃƒO**: Constraint CHECK para notas 0-20 (RN03)
- [x] `assessment_types` - Tipos de avaliaÃ§Ã£o (RF07)
- [x] `attendance` - Controlo de presenÃ§as
- [x] `classes_attended` - Aulas ministradas

---

### 2. ÃREA ADMINISTRATIVA ğŸ¢

#### **GestÃ£o de Pessoal**
- [x] `users` - Dados centrais de todos os utilizadores
- [x] `user_roles` - PapÃ©is no sistema
- [x] `user_identification` - Documentos de identificaÃ§Ã£o
- [x] `user_health` - InformaÃ§Ãµes de saÃºde
- [x] `departments` - Estrutura departamental (RF01)
- [ ] **`department_budgets`** - OrÃ§amento anual por departamento (RF01)
- [ ] **`administrative_staff`** - FuncionÃ¡rios administrativos (RF02)

#### **CoordenaÃ§Ã£o de Cursos**
- [x] `courses.coordinator_user_id` - Coordenadores atribuÃ­dos (RF04)
  - **VALIDAÃ‡ÃƒO**: Apenas coordenadores aprovam carga horÃ¡ria (RN06)

#### **Tesouraria (crÃ­tica para ISPTEC)**
- [ ] **`payment_methods`** - MÃ©todos de pagamento aceitos
- [ ] **`payment_plans`** - Planos de pagamento para estudantes
- [ ] **`financial_transactions`** - Todas as transaÃ§Ãµes financeiras
- [ ] **`scholarships`** - Bolsas de estudo

#### **Biblioteca**
- [ ] **`library_items`** - CatÃ¡logo geral (livros, revistas, computador, etc.)
- [ ] **`library_loans`** - EmprÃ©stimos e devoluÃ§Ãµes

---

### 3. ÃREA OPERACIONAL âš™ï¸

#### **GestÃ£o de Terceirizados**
- [ ] **`service_companies`** - Empresas terceirizadas (RF08)
- [ ] **`service_contracts`** - Contratos com empresas (RF08)
- [ ] **`contract_guarantees`** - Garantias por contrato (RN04)
- [ ] **`sla_definitions`** - DefiniÃ§Ãµes de SLA por contrato (RF08)

#### **Monitoramento e Pagamentos**
- [ ] **`sla_monitoring`** - Monitoramento mensal de SLA (RF09)
- [ ] **`service_payments`** - Pagamentos mensais Ã s empresas (RF09)
  - **VALIDAÃ‡ÃƒO**: Verifica garantia vÃ¡lida antes do pagamento (RN04)
  - **VALIDAÃ‡ÃƒO**: Multa automÃ¡tica se SLA < 90% (RN05)

---

### 4. ÃREAS TRANSVERSAIS ğŸ”„

#### **Auditoria**
- [ ] **`audit_logs`** - Logs de auditoria (RF11)

#### **RelatÃ³rios** (Consultas, nÃ£o tabelas)
- **RF10**: RelatÃ³rios de carga horÃ¡ria, salas e custos
- **Views necessÃ¡rias**:
  - Grade horÃ¡ria por curso
  - Carga horÃ¡ria por professor
  - Resumo de custos de serviÃ§os por mÃªs

---

### 5. VALIDAÃ‡Ã•ES E REGRAS DE NEGÃ“CIO

#### **Procedures (RF - Matricular, Alocar, Processar)**
- [ ] **`sp_matricular_aluno`** - MatrÃ­cula com validaÃ§Ã£o de vaga e propina (RN02)
- [ ] **`sp_alocar_professor`** - AlocaÃ§Ã£o sem sobreposiÃ§Ã£o de horÃ¡rios (RN01)
- [ ] **`sp_processar_pagamento`** - Pagamento com cÃ¡lculo de multa (RN05)

#### **Functions (CÃ¡lculos)**
- [ ] **`fn_calcular_media_ponderada`** - MÃ©dia ponderada do aluno
- [ ] **`fn_calcular_percentual_sla`** - Percentual de SLA mensal

#### **Triggers (ValidaÃ§Ãµes AutomÃ¡ticas)**
- [ ] **`tr_validar_sobreposicao_horario`** - Previne sobreposiÃ§Ã£o de horÃ¡rios (RN01)
- [ ] **`tr_validar_nota_range`** - Valida notas entre 0-20 (RN03)
- [ ] **`tr_bloquear_pagamento_sem_garantia`** - Bloqueia pagamento sem garantia (RN04)
- [ ] **`tr_auditoria_matriculas`** - Auditoria de matrÃ­culas (RF11)
- [ ] **`tr_auditoria_pagamentos`** - Auditoria de pagamentos (RF11)

#### **Views (RelatÃ³rios)**
- [ ] **`vw_grade_horaria_curso`** - Grade horÃ¡ria por curso
- [ ] **`vw_carga_horaria_professor`** - Carga horÃ¡ria por professor
- [ ] **`vw_custos_servicos_mes`** - Resumo de custos mensais

---

